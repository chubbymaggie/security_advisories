> [Suggested description]
> XnView Classic for Windows Version 2.40 allows user-assisted remote 
> attackers to execute code via a crafted JPEG 2000 file that is 
> mishandled during the opening of a directory in "Browser" mode, 
> because of a "Stack Buffer Overrun" issue.
> 
> ------------------------------------------
> 
> [Additional Information]
> This vulnerability can be reproduced by opening the directory 
> containing a crafted .j2k file in "Browser" mode(eg. copy the crafted 
> .j2k file into diretory E:\ and type in command line :
> "E:\XnView\xnview.exe E:\")
> 
> ModLoad: 00000000`61d90000 00000000`61dda000   E:\XnView\Plugins\openjp2.dll
> (9ac.13f0): Security check failure or stack buffer overrun - code 
> c0000409 (!!! second chance !!!)
> *** ERROR: Module load completed but symbols could not be loaded for 
> E:\XnView\xnview.exe
> xnview+0x373222:
> 00683222 cd29            int     29h
> 0:012:x86> r
> eax=00000001 ebx=0406ac48 ecx=00000002 edx=00070888 esi=00000a50 edi=07700048
> eip=00683222 esp=07d4c8c4 ebp=07d4cbe8 iopl=0         nv up ei pl nz na po nc
> cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000202
> xnview+0x373222:
> 00683222 cd29            int     29h
> 0:012:x86> kb
>  # ChildEBP RetAddr  Args to Child              
> WARNING: Stack unwind information not available. Following frames may be wrong.
> 00 07d4cbe8 0057740f 61da37e0 61da37b0 61d91830 xnview+0x373222
> 01 07d4ee20 00000000 00000000 00000000 00000000 xnview+0x26740f
> 
> 0:012:x86> !exploitable -m
> EXCEPTION_FAULTING_ADDRESS:0x683222
> EXCEPTION_CODE:0xC0000409
> EXCEPTION_LEVEL:SECOND_CHANCE
> EXCEPTION_TYPE:STATUS_STACK_BUFFER_OVERRUN
> STACK_DEPTH:2
> STACK_FRAME:xnview+0x373222
> STACK_FRAME:xnview+0x26740f
> INSTRUCTION_ADDRESS:0x0000000000683222
> DESCRIPTION:Stack Buffer Overrun (/GS Exception) 
> SHORT_DESCRIPTION:GSViolation CLASSIFICATION:EXPLOITABLE 
> BUG_TITLE:Exploitable - Stack Buffer Overrun (/GS Exception) starting 
> at xnview+0x0000000000373222 (Hash=0x706b706b.0x70457011) 
> EXPLANATION:An overrun of a protected stack buffer has been detected. This is considered exploitable, and must be fixed.
> 
> ------------------------------------------
> 
> [Vulnerability Type]
> Buffer Overflow
> 
> ------------------------------------------
> 
> [Vendor of Product]
> XnView
> 
> ------------------------------------------
> 
> [Affected Product Code Base]
> XnView - XnView Classic for Windows Version 2.40
> 
> ------------------------------------------
> 
> [Affected Component]
> XnView Classic for Windows Version 2.40
> 
> ------------------------------------------
> 
> [Attack Type]
> Local
> 
> ------------------------------------------
> 
> [Impact Denial of Service]
> true
> 
> ------------------------------------------
> 
> [Attack Vectors]
> application crashed by opening the directory containing a crafted .j2k 
> file in "Browser" mode
> 
> ------------------------------------------
> 
> [Reference]
> http://download3.xnview.com/XnView-win-full.zip
> http://www.xnview.com/
> 
> ------------------------------------------
> 
> [Discoverer]
> Lin Wang, Beihang University, China

Use CVE-2017-8781.
