> [Suggested description]
> Winamp 5.666 Build 3516(x86) might allow attackers to execute arbitrary
> code or cause a denial of service via a crafted .flv file, related to
> "Data from Faulting Address may be used as a return value starting at
> f263!GetWinamp5SystemComponent+0x0000000000001951."
>
> ------------------------------------------
>
> [Additional Information]
> !exploitable -m
> IDENTITY:HostMachine\HostUser
> PROCESSOR:X86
> CLASS:USER
> QUALIFIER:USER_PROCESS
> EVENT:DEBUG_EVENT_EXCEPTION
> EXCEPTION_FAULTING_ADDRESS:0xe2911e1a
> EXCEPTION_CODE:0xC0000005
> EXCEPTION_LEVEL:FIRST_CHANCE
> EXCEPTION_TYPE:STATUS_ACCESS_VIOLATION
> EXCEPTION_SUBTYPE:READ
> FAULTING_INSTRUCTION:08572f15 movzx eax,byte ptr [ecx]
> BASIC_BLOCK_INSTRUCTION_COUNT:18
> BASIC_BLOCK_INSTRUCTION:08572f15 movzx eax,byte ptr [ecx]
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:ecx
> BASIC_BLOCK_INSTRUCTION:08572f18 movzx edi,byte ptr [ecx+1]
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:ecx
> BASIC_BLOCK_INSTRUCTION:08572f1c shl eax,8
> BASIC_BLOCK_INSTRUCTION:08572f1f or eax,edi
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:eax
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:edi
> BASIC_BLOCK_INSTRUCTION:08572f21 movzx edi,byte ptr [ecx+2]
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:ecx
> ...
> MAJOR_HASH:0x0f550611
> MINOR_HASH:0x767e1463
> STACK_DEPTH:10
> STACK_FRAME:f263!GetWinamp5SystemComponent+0x1951
> STACK_FRAME:f263!GetWinamp5SystemComponent+0x28a0
> STACK_FRAME:f263!GetWinamp5SystemComponent+0x2ee3
> STACK_FRAME:f263!GetWinamp5SystemComponent+0x396d
> STACK_FRAME:KERNELBASE!WaitForSingleObjectEx+0x8f
> STACK_FRAME:in_flv!winampGetInModule2+0x341d
> STACK_FRAME:in_flv!winampGetInModule2+0x3678
> STACK_FRAME:KERNEL32!BaseThreadInitThunk+0xe
> STACK_FRAME:ntdll_77130000!__RtlUserThreadStart+0x72
> STACK_FRAME:ntdll_77130000!_RtlUserThreadStart+0x1b
> INSTRUCTION_ADDRESS:0x0000000008572f15
> INVOKING_STACK_FRAME:0
> DESCRIPTION:Data from Faulting Address may be used as a return value
> SHORT_DESCRIPTION:TaintedDataReturnedFromFunction
> CLASSIFICATION:UNKNOWN
> BUG_TITLE:Data from Faulting Address may be used as a return value starting at f263!GetWinamp5SystemComponent+0x0000000000001951 (Hash=0x0f550611.0x767e1463)
> EXPLANATION:The data from the faulting address may later be used as a return value from this function.
>
> ------------------------------------------
>
> [Vulnerability Type]
> Buffer Overflow
>
> ------------------------------------------
>
> [Vendor of Product]
> Winamp
>
> ------------------------------------------
>
> [Affected Product Code Base]
> Winamp - 5.666 Build 3516(x86)
>
> ------------------------------------------
>
> [Affected Component]
> Winamp 5.666 Build 3516(x86)
>
> ------------------------------------------
>
> [Attack Type]
> Local
>
> ------------------------------------------
>
> [Impact Denial of Service]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> crash by opening a crafted .flv file
>
> ------------------------------------------
>
> [Reference]
> www.winamp.com
>
> ------------------------------------------
>
> [Discoverer]
> Lin Wang, Beihang University, China

Use CVE-2017-10726.
