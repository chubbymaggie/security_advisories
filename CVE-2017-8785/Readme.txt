> [Suggested description]
> FastStone Image Viewer 6.2 has a "Data from Faulting Address may be 
> used as a return value" issue. This issue can be triggered by a 
> malformed JPEG 2000 file that is mishandled by FSViewer.exe. Attackers 
> could exploit this issue for DoS (Access Violation) or possibly 
> unspecified other impact.
> 
> ------------------------------------------
> 
> [Additional Information]
> This vulnerability can be reproduced by opening the poc.j2k with FSViewer.exe.
> 
> (10ec.a4c): Access violation - code c0000005 (first chance) First 
> chance exceptions are reported before any exception handling.
> This exception may be expected and handled.
> *** WARNING: Unable to verify checksum for 
> E:\FastStoneImageViewer\FSViewer.exe
> *** ERROR: Module load completed but symbols could not be loaded for 
> E:\FastStoneImageViewer\FSViewer.exe
> FSViewer+0x17dc22:
> 0057dc22 8b4210          mov     eax,dword ptr [edx+10h] ds:002b:00000010=????????
> 
> 0:000:x86> !exploitable -m
> EXCEPTION_FAULTING_ADDRESS:0x10
> EXCEPTION_CODE:0xC0000005
> EXCEPTION_LEVEL:FIRST_CHANCE
> EXCEPTION_TYPE:STATUS_ACCESS_VIOLATION
> EXCEPTION_SUBTYPE:READ
> FAULTING_INSTRUCTION:0057dc22 mov eax,dword ptr [edx+10h]
> BASIC_BLOCK_INSTRUCTION_COUNT:2
> BASIC_BLOCK_INSTRUCTION:0057dc22 mov eax,dword ptr [edx+10h] 
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:edx
> BASIC_BLOCK_INSTRUCTION:0057dc25 ret
>  
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:eax
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:edx
> STACK_DEPTH:64
> STACK_FRAME:FSViewer+0x17dc22
> STACK_FRAME:Unknown
> ...
> INSTRUCTION_ADDRESS:0x000000000057dc22
> INVOKING_STACK_FRAME:0
> DESCRIPTION:Data from Faulting Address may be used as a return value 
> SHORT_DESCRIPTION:TaintedDataReturnedFromFunction
> CLASSIFICATION:UNKNOWN
> BUG_TITLE:Data from Faulting Address may be used as a return value 
> starting at FSViewer+0x000000000017dc22 (Hash=0x535b4c4b.0x1e0a3e5c) 
> EXPLANATION:The data from the faulting address may later be used as a return value from this function.
> 
> ------------------------------------------
> 
> [Vulnerability Type]
> Buffer Overflow
> 
> ------------------------------------------
> 
> [Vendor of Product]
> FastStone Soft
> 
> ------------------------------------------
> 
> [Affected Product Code Base]
> FastStone Image Viewer - 6.2
> 
> ------------------------------------------
> 
> [Affected Component]
> FastStone Image Viewer 6.2
> 
> ------------------------------------------
> 
> [Attack Type]
> Local
> 
> ------------------------------------------
> 
> [Impact Denial of Service]
> true
> 
> ------------------------------------------
> 
> [Attack Vectors]
> application crashed by opening a crafted .j2k file
> 
> ------------------------------------------
> 
> [Reference]
> http://www.faststone.org/
> 
> ------------------------------------------
> 
> [Discoverer]
> Lin Wang, Beihang University, China

Use CVE-2017-8785.
