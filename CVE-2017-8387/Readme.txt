> [Suggested description]
> STDU Viewer version 1.6.375 might allow user-assisted attackers to 
> execute code via a crafted file. One threat model is a victim who 
> obtains an untrusted crafted file from a remote location and issues 
> several user defined commands.
> 
> ------------------------------------------
> 
> [Additional Information]
> This vulnerability can be reproduced by the following steps:
> 1 Open poc.djvu by STDUViewerApp.exe
> 2 Ctrl + 2
> 3 Ctrl + T
> 4 Select Page 1 from "Thumbnails" View
> 5 Repeat "Ctrl + Plus" until 500%
> 6 Ctrl + 2
> 7 Goto Step 5
> 
> (f60.9d8): Access violation - code c0000005 (first chance) First 
> chance exceptions are reported before any exception handling.
> This exception may be expected and handled.
> *** WARNING: Unable to verify checksum for STDUViewer.dll
> *** ERROR: Symbol file could not be found.  Defaulted to export 
> symbols for STDUViewer.dll -
> STDUViewer!DllUnregisterServer+0x1a42b:
> 100349eb 88540d00        mov     byte ptr [ebp+ecx],dl      ss:002b:ffffffff=??
> 0:000:x86> r
> eax=00000000 ebx=097fb200 ecx=ffffffff edx=000000ff esi=48de0000 edi=097fb200
> eip=100349eb esp=0018c9ac ebp=00000000 iopl=0         nv up ei pl nz na pe nc
> cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010206
> STDUViewer!DllUnregisterServer+0x1a42b:
> 100349eb 88540d00        mov     byte ptr [ebp+ecx],dl      ss:002b:ffffffff=??
> !exploitable -m
> EXCEPTION_FAULTING_ADDRESS:0xffffffff
> EXCEPTION_CODE:0xC0000005
> EXCEPTION_LEVEL:FIRST_CHANCE
> EXCEPTION_TYPE:STATUS_ACCESS_VIOLATION
> EXCEPTION_SUBTYPE:WRITE
> STACK_FRAME:STDUViewer!DllUnregisterServer+0x1a42b
> DESCRIPTION:User Mode Write AV
> SHORT_DESCRIPTION:WriteAV
> CLASSIFICATION:EXPLOITABLE
> BUG_TITLE:Exploitable - User Mode Write AV starting at 
> STDUViewer!DllUnregisterServer+0x000000000001a42b (Hash=0x6525051b.0x653a051b) EXPLANATION:User mode write access violations that are not near NULL are exploitable.
> 
> ------------------------------------------
> 
> [Vulnerability Type]
> Buffer Overflow
> 
> ------------------------------------------
> 
> [Affected Product Code Base]
> STDU Viewer - 1.6.375
> 
> ------------------------------------------
> 
> [Affected Component]
> STDU Viewer version 1.6.375
> 
> ------------------------------------------
> 
> [Attack Type]
> Local
> 
> ------------------------------------------
> 
> [Impact Denial of Service]
> true
> 
> ------------------------------------------
> 
> [Attack Vectors]
> application crashed by opening a crafted file and issuing several user 
> defined commands
> 
> ------------------------------------------
> 
> [Reference]
> http://www.stdutility.com/download/stduviewer.zip
> http://www.stdutility.com/stduviewer.html
> 
> ------------------------------------------
> 
> [Discoverer]
> Lin Wang, Beihang University, China

Use CVE-2017-8387.
