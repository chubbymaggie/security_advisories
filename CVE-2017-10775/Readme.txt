> [Suggested description]
> XnView Classic for Windows Version 2.40 might allow attackers to cause a
> denial of service or possibly have unspecified other impact via a
> crafted .rle file, related to a "Read Access Violation starting at
> GDI32!ScriptGetCMapWithSurrogate+0x00000000000001cb."
>
> ------------------------------------------
>
> [Additional Information]
> !exploitable -m
> IDENTITY:HostMachine\HostUser
> PROCESSOR:X86
> CLASS:USER
> QUALIFIER:USER_PROCESS
> EVENT:DEBUG_EVENT_EXCEPTION
> EXCEPTION_FAULTING_ADDRESS:0x5d5d5d5c
> EXCEPTION_CODE:0xC0000005
> EXCEPTION_LEVEL:FIRST_CHANCE
> EXCEPTION_TYPE:STATUS_ACCESS_VIOLATION
> EXCEPTION_SUBTYPE:READ
> FAULTING_INSTRUCTION:77b9168d movzx ecx,word ptr [esi+eax*2]
> BASIC_BLOCK_INSTRUCTION_COUNT:9
> BASIC_BLOCK_INSTRUCTION:77b9168d movzx ecx,word ptr [esi+eax*2]
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:eax
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:esi
> BASIC_BLOCK_INSTRUCTION:77b91691 movzx eax,dl
> BASIC_BLOCK_INSTRUCTION:77b91694 shl ecx,8
> BASIC_BLOCK_INSTRUCTION:77b91697 or ecx,eax
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:ecx
> BASIC_BLOCK_INSTRUCTION:77b91699 movzx eax,word ptr [esi+ecx*2]
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:ecx
> BASIC_BLOCK_INSTRUCTION_TAINTED_INPUT_OPERAND:esi
> BASIC_BLOCK_INSTRUCTION:77b9169d lea ecx,[edi-0fe00h]
> BASIC_BLOCK_INSTRUCTION:77b916a3 mov edi,dword ptr [esp+0ch]
> BASIC_BLOCK_INSTRUCTION:77b916a7 cmp ecx,0fh
> BASIC_BLOCK_INSTRUCTION:77b916aa jbe gdi32!scriptgetcmapwithsurrogate+0x1ea (77bdd164)
> MAJOR_HASH:0x52353f63
> MINOR_HASH:0x2d0e6464
> STACK_DEPTH:31
> STACK_FRAME:GDI32!ScriptGetCMapWithSurrogate+0x1cb
> STACK_FRAME:GDI32!ScriptStringBreakoutMissingGlyphs+0x5e
> STACK_FRAME:GDI32!ScriptStringAnalyzeGlyphs+0xb7
> STACK_FRAME:GDI32!ScriptStringAnalyse+0x265
> STACK_FRAME:GDI32!LpkCharsetDraw+0x449
> STACK_FRAME:GDI32!LpkDrawTextEx+0x2f
> STACK_FRAME:USER32!DT_DrawStr+0x16d
> STACK_FRAME:USER32!DT_GetLineBreak+0x96
> STACK_FRAME:USER32!DrawTextExWorker+0x2fd
> STACK_FRAME:USER32!MB_CalcDialogSize+0x1a3
> STACK_FRAME:USER32!SoftModalMessageBox+0x3a3
> ...
> INSTRUCTION_ADDRESS:0x0000000077b9168d
> INVOKING_STACK_FRAME:0
> DESCRIPTION:Read Access Violation
> SHORT_DESCRIPTION:ReadAV
> CLASSIFICATION:UNKNOWN
> BUG_TITLE:Read Access Violation starting at GDI32!ScriptGetCMapWithSurrogate+0x00000000000001cb (Hash=0x52353f63.0x2d0e6464)
>
> ------------------------------------------
>
> [Vulnerability Type]
> Buffer Overflow
>
> ------------------------------------------
>
> [Vendor of Product]
> XnView
>
> ------------------------------------------
>
> [Affected Product Code Base]
> XnView - Classic for Windows Version 2.40
>
> ------------------------------------------
>
> [Affected Component]
> XnView Classic for Windows Version 2.40
>
> ------------------------------------------
>
> [Attack Type]
> Local
>
> ------------------------------------------
>
> [Impact Denial of Service]
> true
>
> ------------------------------------------
>
> [Attack Vectors]
> crash by opening a crafted .rle file
>
> ------------------------------------------
>
> [Reference]
> http://www.xnview.com/
>
> ------------------------------------------
>
> [Discoverer]
> Lin Wang, Beihang University, China

Use CVE-2017-10775.
